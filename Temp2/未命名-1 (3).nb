(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     16780,        397]
NotebookOptionsPosition[     15831,        362]
NotebookOutlinePosition[     16188,        378]
CellTagsIndexPosition[     16145,        375]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"total", "=", "N"}], ";", 
  RowBox[{"num", "=", "n"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "<", "num"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"safe", "=", 
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"100", 
         RowBox[{"total", "/", 
          RowBox[{"(", 
           RowBox[{"num", "-", "i"}], ")"}]}]}], "-", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"money", "=", 
      RowBox[{
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "safe"}], "}"}], "]"}], "/", "100"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"total", "=", 
      RowBox[{"total", "-", "money"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"N", "[", "money", "]"}], "]"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"N", "[", "total", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6605641923096914`*^9, 3.6605641996925535`*^9}, {
   3.6605642302449083`*^9, 3.6605642868679004`*^9}, {3.660564322858924*^9, 
   3.6605643969879084`*^9}, {3.660564428298399*^9, 3.6605644956455116`*^9}, {
   3.6605645616403713`*^9, 3.660564567362336*^9}, {3.660564602938452*^9, 
   3.660564621039187*^9}, 3.660564703186144*^9, {3.6605647425933323`*^9, 
   3.66056477410365*^9}, {3.660564813809316*^9, 3.6605648378933687`*^9}, {
   3.660564940924201*^9, 3.6605649479676933`*^9}, {3.6605649901504345`*^9, 
   3.6605650486153417`*^9}, {3.660565097150613*^9, 3.660565161870837*^9}, {
   3.6605652275367603`*^9, 3.660565331947094*^9}, {3.6605654056772327`*^9, 
   3.6605654124082737`*^9}, {3.6605654458187532`*^9, 
   3.6605654602252593`*^9}, {3.6605659274582877`*^9, 3.660565952450412*^9}, {
   3.660566406104658*^9, 3.6605664679727592`*^9}, {3.6605665233966413`*^9, 
   3.6605666121226997`*^9}, {3.660566661162504*^9, 3.660566682024273*^9}, 
   3.660566849958042*^9, {3.6605669308194714`*^9, 3.660566953868082*^9}, {
   3.6605670132201557`*^9, 3.6605670499769697`*^9}, {3.660567133194147*^9, 
   3.6605671682096376`*^9}, {3.6605685264670553`*^9, 3.660568529975931*^9}, 
   3.6605968694193645`*^9}],

Cell[CellGroupData[{

Cell[BoxData["0.89`"], "Print",
 CellChangeTimes->{{3.660564846397463*^9, 3.6605648507420835`*^9}, {
   3.6605649427631483`*^9, 3.660564949120322*^9}, {3.660564998953*^9, 
   3.6605650491826277`*^9}, {3.6605650985985146`*^9, 3.660565105331132*^9}, {
   3.660565142413287*^9, 3.660565166418359*^9}, {3.660565229013789*^9, 
   3.6605652349468193`*^9}, {3.6605652658882256`*^9, 3.660565332552404*^9}, 
   3.6605654136404886`*^9, {3.660565455614609*^9, 3.6605654609031305`*^9}, 
   3.660565953453556*^9, 3.660566469825941*^9, {3.660566525331236*^9, 
   3.6605666132074356`*^9}, {3.6605666721579614`*^9, 3.660566682986902*^9}, 
   3.6605667835956116`*^9, {3.6605669348085337`*^9, 3.6605669556184387`*^9}, {
   3.660567041569208*^9, 3.660567050796591*^9}, {3.660567142908968*^9, 
   3.660567169550439*^9}}],

Cell[BoxData["0.77`"], "Print",
 CellChangeTimes->{{3.660564846397463*^9, 3.6605648507420835`*^9}, {
   3.6605649427631483`*^9, 3.660564949120322*^9}, {3.660564998953*^9, 
   3.6605650491826277`*^9}, {3.6605650985985146`*^9, 3.660565105331132*^9}, {
   3.660565142413287*^9, 3.660565166418359*^9}, {3.660565229013789*^9, 
   3.6605652349468193`*^9}, {3.6605652658882256`*^9, 3.660565332552404*^9}, 
   3.6605654136404886`*^9, {3.660565455614609*^9, 3.6605654609031305`*^9}, 
   3.660565953453556*^9, 3.660566469825941*^9, {3.660566525331236*^9, 
   3.6605666132074356`*^9}, {3.6605666721579614`*^9, 3.660566682986902*^9}, 
   3.6605667835956116`*^9, {3.6605669348085337`*^9, 3.6605669556184387`*^9}, {
   3.660567041569208*^9, 3.660567050796591*^9}, {3.660567142908968*^9, 
   3.6605671695539403`*^9}}],

Cell[BoxData["0.29`"], "Print",
 CellChangeTimes->{{3.660564846397463*^9, 3.6605648507420835`*^9}, {
   3.6605649427631483`*^9, 3.660564949120322*^9}, {3.660564998953*^9, 
   3.6605650491826277`*^9}, {3.6605650985985146`*^9, 3.660565105331132*^9}, {
   3.660565142413287*^9, 3.660565166418359*^9}, {3.660565229013789*^9, 
   3.6605652349468193`*^9}, {3.6605652658882256`*^9, 3.660565332552404*^9}, 
   3.6605654136404886`*^9, {3.660565455614609*^9, 3.6605654609031305`*^9}, 
   3.660565953453556*^9, 3.660566469825941*^9, {3.660566525331236*^9, 
   3.6605666132074356`*^9}, {3.6605666721579614`*^9, 3.660566682986902*^9}, 
   3.6605667835956116`*^9, {3.6605669348085337`*^9, 3.6605669556184387`*^9}, {
   3.660567041569208*^9, 3.660567050796591*^9}, {3.660567142908968*^9, 
   3.660567169560994*^9}}],

Cell[BoxData["1.03`"], "Print",
 CellChangeTimes->{{3.660564846397463*^9, 3.6605648507420835`*^9}, {
   3.6605649427631483`*^9, 3.660564949120322*^9}, {3.660564998953*^9, 
   3.6605650491826277`*^9}, {3.6605650985985146`*^9, 3.660565105331132*^9}, {
   3.660565142413287*^9, 3.660565166418359*^9}, {3.660565229013789*^9, 
   3.6605652349468193`*^9}, {3.6605652658882256`*^9, 3.660565332552404*^9}, 
   3.6605654136404886`*^9, {3.660565455614609*^9, 3.6605654609031305`*^9}, 
   3.660565953453556*^9, 3.660566469825941*^9, {3.660566525331236*^9, 
   3.6605666132074356`*^9}, {3.6605666721579614`*^9, 3.660566682986902*^9}, 
   3.6605667835956116`*^9, {3.6605669348085337`*^9, 3.6605669556184387`*^9}, {
   3.660567041569208*^9, 3.660567050796591*^9}, {3.660567142908968*^9, 
   3.660567169568005*^9}}],

Cell[BoxData["0.03`"], "Print",
 CellChangeTimes->{{3.660564846397463*^9, 3.6605648507420835`*^9}, {
   3.6605649427631483`*^9, 3.660564949120322*^9}, {3.660564998953*^9, 
   3.6605650491826277`*^9}, {3.6605650985985146`*^9, 3.660565105331132*^9}, {
   3.660565142413287*^9, 3.660565166418359*^9}, {3.660565229013789*^9, 
   3.6605652349468193`*^9}, {3.6605652658882256`*^9, 3.660565332552404*^9}, 
   3.6605654136404886`*^9, {3.660565455614609*^9, 3.6605654609031305`*^9}, 
   3.660565953453556*^9, 3.660566469825941*^9, {3.660566525331236*^9, 
   3.6605666132074356`*^9}, {3.6605666721579614`*^9, 3.660566682986902*^9}, 
   3.6605667835956116`*^9, {3.6605669348085337`*^9, 3.6605669556184387`*^9}, {
   3.660567041569208*^9, 3.660567050796591*^9}, {3.660567142908968*^9, 
   3.6605671695760436`*^9}}],

Cell[BoxData["0.51`"], "Print",
 CellChangeTimes->{{3.660564846397463*^9, 3.6605648507420835`*^9}, {
   3.6605649427631483`*^9, 3.660564949120322*^9}, {3.660564998953*^9, 
   3.6605650491826277`*^9}, {3.6605650985985146`*^9, 3.660565105331132*^9}, {
   3.660565142413287*^9, 3.660565166418359*^9}, {3.660565229013789*^9, 
   3.6605652349468193`*^9}, {3.6605652658882256`*^9, 3.660565332552404*^9}, 
   3.6605654136404886`*^9, {3.660565455614609*^9, 3.6605654609031305`*^9}, 
   3.660565953453556*^9, 3.660566469825941*^9, {3.660566525331236*^9, 
   3.6605666132074356`*^9}, {3.6605666721579614`*^9, 3.660566682986902*^9}, 
   3.6605667835956116`*^9, {3.6605669348085337`*^9, 3.6605669556184387`*^9}, {
   3.660567041569208*^9, 3.660567050796591*^9}, {3.660567142908968*^9, 
   3.6605671695965815`*^9}}],

Cell[BoxData["1.19`"], "Print",
 CellChangeTimes->{{3.660564846397463*^9, 3.6605648507420835`*^9}, {
   3.6605649427631483`*^9, 3.660564949120322*^9}, {3.660564998953*^9, 
   3.6605650491826277`*^9}, {3.6605650985985146`*^9, 3.660565105331132*^9}, {
   3.660565142413287*^9, 3.660565166418359*^9}, {3.660565229013789*^9, 
   3.6605652349468193`*^9}, {3.6605652658882256`*^9, 3.660565332552404*^9}, 
   3.6605654136404886`*^9, {3.660565455614609*^9, 3.6605654609031305`*^9}, 
   3.660565953453556*^9, 3.660566469825941*^9, {3.660566525331236*^9, 
   3.6605666132074356`*^9}, {3.6605666721579614`*^9, 3.660566682986902*^9}, 
   3.6605667835956116`*^9, {3.6605669348085337`*^9, 3.6605669556184387`*^9}, {
   3.660567041569208*^9, 3.660567050796591*^9}, {3.660567142908968*^9, 
   3.6605671696141205`*^9}}],

Cell[BoxData["2.47`"], "Print",
 CellChangeTimes->{{3.660564846397463*^9, 3.6605648507420835`*^9}, {
   3.6605649427631483`*^9, 3.660564949120322*^9}, {3.660564998953*^9, 
   3.6605650491826277`*^9}, {3.6605650985985146`*^9, 3.660565105331132*^9}, {
   3.660565142413287*^9, 3.660565166418359*^9}, {3.660565229013789*^9, 
   3.6605652349468193`*^9}, {3.6605652658882256`*^9, 3.660565332552404*^9}, 
   3.6605654136404886`*^9, {3.660565455614609*^9, 3.6605654609031305`*^9}, 
   3.660565953453556*^9, 3.660566469825941*^9, {3.660566525331236*^9, 
   3.6605666132074356`*^9}, {3.6605666721579614`*^9, 3.660566682986902*^9}, 
   3.6605667835956116`*^9, {3.6605669348085337`*^9, 3.6605669556184387`*^9}, {
   3.660567041569208*^9, 3.660567050796591*^9}, {3.660567142908968*^9, 
   3.6605671696321173`*^9}}],

Cell[BoxData["2.52`"], "Print",
 CellChangeTimes->{{3.660564846397463*^9, 3.6605648507420835`*^9}, {
   3.6605649427631483`*^9, 3.660564949120322*^9}, {3.660564998953*^9, 
   3.6605650491826277`*^9}, {3.6605650985985146`*^9, 3.660565105331132*^9}, {
   3.660565142413287*^9, 3.660565166418359*^9}, {3.660565229013789*^9, 
   3.6605652349468193`*^9}, {3.6605652658882256`*^9, 3.660565332552404*^9}, 
   3.6605654136404886`*^9, {3.660565455614609*^9, 3.6605654609031305`*^9}, 
   3.660565953453556*^9, 3.660566469825941*^9, {3.660566525331236*^9, 
   3.6605666132074356`*^9}, {3.6605666721579614`*^9, 3.660566682986902*^9}, 
   3.6605667835956116`*^9, {3.6605669348085337`*^9, 3.6605669556184387`*^9}, {
   3.660567041569208*^9, 3.660567050796591*^9}, {3.660567142908968*^9, 
   3.6605671696499605`*^9}}],

Cell[BoxData["0.3`"], "Print",
 CellChangeTimes->{{3.660564846397463*^9, 3.6605648507420835`*^9}, {
   3.6605649427631483`*^9, 3.660564949120322*^9}, {3.660564998953*^9, 
   3.6605650491826277`*^9}, {3.6605650985985146`*^9, 3.660565105331132*^9}, {
   3.660565142413287*^9, 3.660565166418359*^9}, {3.660565229013789*^9, 
   3.6605652349468193`*^9}, {3.6605652658882256`*^9, 3.660565332552404*^9}, 
   3.6605654136404886`*^9, {3.660565455614609*^9, 3.6605654609031305`*^9}, 
   3.660565953453556*^9, 3.660566469825941*^9, {3.660566525331236*^9, 
   3.6605666132074356`*^9}, {3.6605666721579614`*^9, 3.660566682986902*^9}, 
   3.6605667835956116`*^9, {3.6605669348085337`*^9, 3.6605669556184387`*^9}, {
   3.660567041569208*^9, 3.660567050796591*^9}, {3.660567142908968*^9, 
   3.6605671696643353`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1.1", ",", "2.3", ",", 
       RowBox[{"-", "2.4"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2.3", ",", 
       RowBox[{"-", "2.2"}], ",", "4.45"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2.4"}], ",", "4.45", ",", "4.2"}], "}"}]}], "}"}]}], ";", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"lam", ",", "vec"}], "}"}], "=", 
   RowBox[{"Eigensystem", "[", "mat", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"vec", "=", 
   RowBox[{"Transpose", "[", "vec", "]"}]}], ";"}], "\n", 
 RowBox[{"vec", "//", "MatrixForm"}], "\n", 
 RowBox[{"Diagonal", "[", 
  RowBox[{
   RowBox[{"Inverse", "[", "vec", "]"}], ".", "mat", ".", "vec"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.6621765500569744`*^9, 3.662176553460725*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "0.2225854078393581`"}], "0.4134335121560841`", 
      "0.8829090934197424`"},
     {"0.3883052507859446`", 
      RowBox[{"-", "0.7930972769902652`"}], "0.4692715007782715`"},
     {"0.8942453625426589`", "0.44729122532966314`", "0.015993477234080417`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.662176556098547*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6.72968976923713`", ",", 
   RowBox[{"-", "5.908678766163636`"}], ",", "2.278988996926504`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6621765560995474`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"answer", "=", 
   RowBox[{"RSolveValue", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"h", "[", "n", "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{"1.06", 
          RowBox[{"h", "[", 
           RowBox[{"n", "-", "1"}], "]"}]}], "+", "100"}]}], ",", 
       RowBox[{
        RowBox[{"h", "[", "0", "]"}], "\[Equal]", "500"}]}], "}"}], ",", 
     RowBox[{"h", "[", "n", "]"}], ",", "n"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"function", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"GeneratingFunction", "[", 
      RowBox[{"answer", ",", "n", ",", "x"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"SeriesCoefficient", "[", 
     RowBox[{"function", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "n"}], "}"}]}], "]"}], "==", "answer"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "answer", "]"}], ";", 
  RowBox[{"Print", "[", "function", "]"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "(*", "p\:4e2aq\:9762\:9ab0\:5b50\:53d6\:6700\:5927\:7684k\:4e2a\:503c", 
   "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"p", " ", "=", " ", "5"}], ";", " ", 
    RowBox[{"q", " ", "=", " ", "20"}], ";", " ", 
    RowBox[{"k", " ", "=", " ", "3"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"all", " ", "=", " ", 
     RowBox[{"Tuples", "[", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{"1", ",", " ", "q"}], "]"}], ",", " ", "p"}], "]"}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{"sta", " ", "=", " ", 
     RowBox[{"Tally", "[", 
      RowBox[{"Map", "[", 
       RowBox[{"Total", ",", " ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{"TakeLargest", "[", "k", "]"}], ",", " ", "all"}], "]"}]}], 
       "]"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      TagBox[
       StyleBox["CirclePlus",
        ShowSpecialCharacters->False,
        ShowStringCharacters->True,
        NumberMarks->True],
       FullForm], " ", "[", 
      RowBox[{"{", 
       RowBox[{"a_", " ", ",", " ", "b_"}], " ", "}"}], "]"}], " ", ":=", " ", 
     RowBox[{"b", "*", 
      RowBox[{"x", "^", "a"}]}]}], ";"}], "\n", 
   RowBox[{"muf", " ", "=", " ", 
    RowBox[{
     RowBox[{"Total", "[", 
      RowBox[{"Map", "[", 
       RowBox[{
        TagBox[
         StyleBox["CirclePlus",
          ShowSpecialCharacters->False,
          ShowStringCharacters->True,
          NumberMarks->True],
         FullForm], ",", " ", "sta"}], "]"}], "]"}], "/", 
     RowBox[{"(", 
      RowBox[{"q", "^", "p"}], ")"}]}]}], "\n", 
   RowBox[{"answer", " ", "=", " ", 
    RowBox[{"Limit", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"muf", ",", " ", "x"}], "]"}], ",", " ", 
      RowBox[{"x", " ", "->", " ", "1"}]}], "]"}]}]}]}]], "Input"]
},
WindowSize->{844, 833},
WindowMargins->{{345, Automatic}, {32, Automatic}},
FrontEndVersion->"10.3 for Microsoft Windows (64-bit) (2015\:5e7411\:67084\
\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 2261, 48, 258, "Input"],
Cell[CellGroupData[{
Cell[2866, 74, 800, 11, 23, "Print"],
Cell[3669, 87, 802, 11, 23, "Print"],
Cell[4474, 100, 800, 11, 23, "Print"],
Cell[5277, 113, 800, 11, 23, "Print"],
Cell[6080, 126, 802, 11, 23, "Print"],
Cell[6885, 139, 802, 11, 23, "Print"],
Cell[7690, 152, 802, 11, 23, "Print"],
Cell[8495, 165, 802, 11, 23, "Print"],
Cell[9300, 178, 802, 11, 23, "Print"],
Cell[10105, 191, 801, 11, 23, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[10955, 208, 862, 26, 182, "Input"],
Cell[11820, 236, 875, 22, 57, "Output"],
Cell[12698, 260, 199, 5, 31, "Output"]
}, Open  ]],
Cell[12912, 268, 1082, 33, 182, "Input"],
Cell[13997, 303, 1830, 57, 240, "Input"]
}
]
*)

(* End of internal cache information *)
